create or replace FUNCTION UPDATE_DRIVER(ID1 IN DRIVERS.ID%TYPE, LICENSE_NUMBER1 IN  DRIVERS.LICENSE_NUMBER%TYPE) 
RETURNS INTEGER 
AS $$
DECLARE
    ROW_COUNT INTEGER := 0;
    ROW_DRIVER DRIVERS%ROWTYPE;
	v_result varchar(250);
BEGIN
    SELECT COUNT(*) INTO ROW_COUNT FROM DRIVERS WHERE ID = ID1;
    IF ROW_COUNT = 0 THEN
		select show_message('ID DOES NOT EXIST !') into v_result;
        RETURN 1;
    ELSE
        SELECT * INTO ROW_DRIVER FROM DRIVERS WHERE ID = ID1;
        IF LICENSE_NUMBER1 IS NULL THEN
            LICENSE_NUMBER1 := ROW_DRIVER.LICENSE_NUMBER;
        ELSE
            SELECT COUNT(*) INTO ROW_COUNT FROM DRIVERS WHERE LICENSE_NUMBER = LICENSE_NUMBER1;
            IF ROW_COUNT > 0 THEN
				select show_message('DUPLICATE IN LICENSE_NUMBER !') into v_result;
                RETURN 2;
            END IF;
        END IF;
        UPDATE DRIVERS SET LICENSE_NUMBER = LICENSE_NUMBER1,CREATED_AT = CREATED_AT, UPDATED_AT = CURRENT_TIMESTAMP 
		WHERE ID = ID1;
       	select show_message('UPDATING DRIVERS IS SUCCESSFUL !') into v_result;
		
    END IF;
    RETURN 0;
END ;
$$ language plpgsql;