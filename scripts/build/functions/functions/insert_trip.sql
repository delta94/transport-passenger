create or replace FUNCTION INSERT_TRIP(ID1 IN TRIPS.ID%TYPE, TRIP_DAILY_ID1 IN TRIPS.TRIP_DAILY_ID%TYPE, DEPART_DATE1 IN TRIPS.DEPART_DATE%TYPE,
BUS_ID1 IN TRIPS.BUS_ID%TYPE, DRIVER_ID1 IN TRIPS.DRIVER_ID%TYPE, ASSISTANT_ID1 IN TRIPS.ASSISTANT_ID%TYPE, IS_COMPLETE1 IN TRIPS.IS_COMPLETE%TYPE) 
RETURNS INTEGER 
AS $$
DECLARE
    ROW_COUNT INTEGER := 0;
	v_result varchar(250);
BEGIN
    SELECT COUNT(*) INTO ROW_COUNT FROM TRIPS WHERE ID = ID1;
    IF ROW_COUNT > 0 THEN
        select show_message('Duplicate of ID !') into v_result;
		RETURN 1;
    END IF;
    
    SELECT COUNT(*) INTO ROW_COUNT FROM TRIP_DAILIES WHERE ID = TRIP_DAILY_ID1;
    IF ROW_COUNT = 0 THEN
		select show_message('TRIP_DAILY_ID DOES NOT EXIST !') into v_result;
        RETURN 2;
    END IF;
    
    SELECT COUNT(*) INTO ROW_COUNT FROM BUSES WHERE ID = BUS_ID1;
    IF ROW_COUNT = 0 THEN
		select show_message('BUS_ID DOES NOT EXIST !') into v_result;
        RETURN 3;
    END IF;
    
    SELECT COUNT(*) INTO ROW_COUNT FROM DRIVERS WHERE ID = DRIVER_ID1;
    IF ROW_COUNT = 0 THEN
		select show_message('DRIVER_ID DOES NOT EXIST !') into v_result;
        RETURN 4;
    END IF;
    
    SELECT COUNT(*) INTO ROW_COUNT FROM ASSISTANTS WHERE ID = ASSISTANT_ID1;
    IF ROW_COUNT = 0 THEN
		select show_message('ASSISTANT_ID DOES NOT EXIST !') into v_result;
        RETURN 5;
    END IF;
    
    INSERT INTO TRIP VALUES(ID1,TRIP_DAILY_ID1,DEPART_DATE1,BUS_ID1,DRIVER_ID1,ASSISTANT_ID1,IS_COMPLETE1,CREATED_AT1,UPDATED_AT1);
    select show_message('Inserting TRIPS is successful !') into v_result;
    
    RETURN 0;
END ;
$$ language plpgsql;