create or replace FUNCTION UPDATE_BUS_STATION(ID1 IN BUS_STATIONS.ID%TYPE, ESTABLISH_DATE1 IN  BUS_STATIONS.ESTABLISH_DATE%TYPE, 
OWNER_NAME1 IN  BUS_STATIONS.OWNER_NAME%TYPE)
RETURNS INTEGER 
AS $$
DECLARE
    ROW_COUNT INTEGER := 0;
    ROW_BUS_STATION BUS_STATIONS%ROWTYPE;
	v_result varchar(250);
BEGIN
    SELECT COUNT(*) INTO ROW_COUNT FROM BUS_STATIONS WHERE ID = ID1;
    IF ROW_COUNT = 0 THEN
		select show_message('ID DOES NOT EXIST !') into v_result;
        RETURN 1;
    ELSE
        SELECT * INTO ROW_BUS_STATION FROM BUS_STATIONS WHERE ID = ID1;
        
        IF ESTABLISH_DATE1 IS NULL THEN
            ESTABLISH_DATE1 := ROW_BUS_STATION.ESTABLISH_DATE;
        END IF;
        
        IF OWNER_NAME1 IS NULL THEN
            OWNER_NAME1 := ROW_BUS_STATION.OWNER_NAME;
        END IF;
        
        UPDATE BUS_STATIONS SET ESTABLISH_DATE = ESTABLISH_DATE1, OWNER_NAME = OWNER_NAME1, CREATED_AT = CREATED_AT, UPDATED_AT = CURRENT_TIMESTAMP 
        WHERE ID = ID1;
	select show_message('UPDATING BUS_STATIONS IS SUCCESSFUL !') into v_result;
        
    END IF;
    
    RETURN 0;
END ;
$$ language plpgsql;